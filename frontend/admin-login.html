<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JaagrukVoter - Admin Login</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
      body { font-family: 'Inter', sans-serif; }
      /* Light loader for dark background */
      .loader-light {
          border: 2px solid rgba(255,255,255,0.3);
          border-top: 2px solid #ffffff;
          border-radius: 50%;
          width: 16px;
          height: 16px;
          animation: spin 1s linear infinite;
          display: inline-block;
      }
      @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center bg-slate-900 px-4">
  <div class="bg-slate-800 shadow-2xl rounded-2xl p-8 w-full max-w-md text-white border border-slate-700">
    <div class="text-center mb-8">
        <h1 class="text-2xl font-bold mb-1">Admin Portal</h1>
        <p class="text-slate-400 text-sm">Restricted Access Area</p>
    </div>

    <!-- Admin Login Form -->
    <form id="adminForm" onsubmit="event.preventDefault();">
        <div class="mb-4">
            <label class="block mb-2 text-sm font-medium text-slate-300" for="email">Admin Email</label>
            <input
              id="email"
              type="email"
              required
              class="w-full px-4 py-3 rounded-lg bg-slate-900 border border-slate-600 focus:outline-none focus:ring-2 focus:ring-sky-500 text-white placeholder-slate-500 transition-all"
              placeholder="admin@example.com"
            />
        </div>

        <div class="mb-6">
            <label class="block mb-2 text-sm font-medium text-slate-300" for="password">Password</label>
            <input
              id="password"
              type="password"
              required
              class="w-full px-4 py-3 rounded-lg bg-slate-900 border border-slate-600 focus:outline-none focus:ring-2 focus:ring-sky-500 text-white placeholder-slate-500 transition-all"
              placeholder="••••••••"
            />
        </div>

        <button
          id="loginBtn"
          type="submit"
          class="w-full bg-sky-600 hover:bg-sky-500 text-white py-3 rounded-lg font-bold transition-all transform active:scale-95 flex items-center justify-center gap-2"
        >
          <span>Login to Dashboard</span>
        </button>
    </form>

    <!-- Error Message -->
    <div id="error" class="mt-4 p-3 bg-red-900/50 border border-red-500/50 text-red-200 text-sm rounded hidden text-center"></div>

    <div class="mt-6 text-center pt-6 border-t border-slate-700">
      <a href="login.html" class="text-slate-400 hover:text-white text-xs flex items-center justify-center gap-1 transition-colors">
        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
        Back to User Login
      </a>
    </div>
  </div>

  <script>
    const API_BASE = "https://jaagrukvoter-backend-2.onrender.com";
    
    // DOM Elements
    const DOM = {
        email: document.getElementById("email"),
        password: document.getElementById("password"),
        loginBtn: document.getElementById("loginBtn"),
        error: document.getElementById("error")
    };

    // UI Helper Functions
    const UI = {
        setLoading: (isLoading) => {
            const btn = DOM.loginBtn;
            if (isLoading) {
                btn.innerHTML = `<div class="loader-light"></div> Verifying...`;
                btn.classList.add('opacity-75', 'cursor-not-allowed');
                btn.disabled = true;
            } else {
                btn.innerHTML = `<span>Login to Dashboard</span>`;
                btn.classList.remove('opacity-75', 'cursor-not-allowed');
                btn.disabled = false;
            }
        },
        showError: (msg) => {
            DOM.error.textContent = msg;
            DOM.error.classList.remove("hidden");
        },
        hideError: () => {
            DOM.error.classList.add("hidden");
        }
    };

    // Login Logic
    DOM.loginBtn.addEventListener("click", async (e) => {
      e.preventDefault();
      UI.hideError();

      const email = DOM.email.value.trim();
      const password = DOM.password.value.trim();

      if (!email || !password) {
        UI.showError("Please enter both email and password.");
        return;
      }

      UI.setLoading(true);

      try {
        const res = await fetch(`${API_BASE}/api/admin/login`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email, password })
        });

        const data = await res.json();
        if (!res.ok) throw new Error(data.error || "Invalid credentials");

        // Success
        localStorage.setItem("adminToken", data.token);
        window.location.href = "admin-dashboard.html";
      } catch (err) {
        UI.showError(err.message);
        UI.setLoading(false);
      }
    });
  </script>
</body>
</html>